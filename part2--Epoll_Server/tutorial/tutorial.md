### 上一章的EPOLL版本

## epoll是什么

epoll就是一种多路复用技术，什么是多路复用？

大家都知道无线电在发射的时候会向整个空间震荡，那么如果别人也要发无线电不是就和我发射的撞车了吗，那为什么收音机可以收到那么多电台呢？

聪明的你已经发现了，每个不同的电台发射的无线电波的频率是不同的，这样就可以在收音机中解调（学过物理的都懂，内部的电路会放大某个频率从而实现接收特定频率的电磁波）

这样在一整个空间中就可以发送不同的信号，互不干扰，这就是多路复用技术

回想一下我们part1是怎么实现多人访问的，我们在主线程监听客户端的连接请求，
```int s = accept(serv_sock, (struct sockaddr*)&clnt_adr, &clnt_adr_size);```一旦连上就新创建一个线程去处理``` if (pthread_create(&t_id, NULL, request_handler, ps) != 0) ```

但是对于我们这种静态托管（只处理服务器的get请求，发送服务器想get的文件）只需要把我们的http网页发给服务器，发送http（io）的开销远小于创建线程的开销，即使是创建线程池避免创建线程也需要考虑线程上下文切换，锁的获取与释放，我们的html要达到200kb才能体现出多线程的优势，还有一点是我们可能很穷，买的服务器就只有一个核心，这样子不如在主线程处理所有人的连接

epoll就是如此

## epoll的工作原理

epoll其实是把我们的服务socket和客户socket都注册给系统，当出现消息（服务socket的：有新客户请求连接，请处理；客户socket的：我想请求消息请给我发送）就会注册进消息数组通知主线程处理

先创建epoll...

再绑定服务端socket...

拉取请求...

当出现客户端连接时处理


